<div class="table-container">
  <div class="loading-overlay" *ngIf="loading">
    <mat-spinner diameter="40"></mat-spinner>
  </div>

  <table mat-table [dataSource]="dataSource" matSort (matSortChange)="onSortChangeInternal($event)" class="data-table">
    
    <!-- Columnas dinÃ¡micas -->
    <ng-container *ngFor="let column of columns" [matColumnDef]="column.key">
      <th mat-header-cell *matHeaderCellDef [mat-sort-header]="column.sortable ? column.key : ''" [style.width]="column.width">
        {{ column.label }}
      </th>
      <td mat-cell *matCellDef="let row" [style.width]="column.width">
        {{ getColumnValue(row, column) }}
      </td>
    </ng-container>

    <!-- Columna de acciones -->
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Acciones</th>
      <td mat-cell *matCellDef="let row">
        <div class="action-buttons">
          <button
            *ngFor="let action of actions"
            mat-icon-button
            [color]="action.color || 'primary'"
            [matTooltip]="action.label"
            (click)="executeAction(action, row, $event)"
            [hidden]="!shouldShowAction(action, row)">
            <mat-icon>{{ action.icon }}</mat-icon>
          </button>
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr 
      mat-row 
      *matRowDef="let row; columns: displayedColumns;"
      (click)="onRowClick(row)"
      class="table-row">
    </tr>

    <!-- Mensaje cuando no hay datos -->
    <tr class="mat-row" *matNoDataRow>
      <td class="mat-cell no-data" [attr.colspan]="displayedColumns.length">
        <div class="no-data-message">
          <mat-icon>inbox</mat-icon>
          <p>No hay datos para mostrar</p>
        </div>
      </td>
    </tr>
  </table>

  <mat-paginator
    *ngIf="showPagination"
    [pageSize]="pageSize"
    [pageSizeOptions]="pageSizeOptions"
    [length]="dataSource.data.length"
    (page)="onPageChangeInternal($event)"
    showFirstLastButtons>
  </mat-paginator>
</div>
